<tal:block replace="nothing">
-*- coding: utf-8 -*-
## CMFPlacefulWorkflow
## Copyright (C)2005 Ingeniweb

## This program is free software; you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation; either version 2 of the License, or
## (at your option) any later version.

## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.

## You should have received a copy of the GNU General Public License
## along with this program; see the file COPYING. If not, write to the
## Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

CMFPlacefulWorkflow configuration panel

# $Source: /cvsroot/ingeniweb/CMFPlacefulWorkflow/skins/CMFPlacefulWorkflow/prefs_workflow_localpolicies_form.pt,v $
# $Id$
</tal:block>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="cmfplacefulworkflow">

    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border',1)" />

    <body>

        <div metal:fill-slot="prefs_configlet_main"
             tal:define="errors python:request.get('errors', {})"
             class="configlet">

            <div id="content" class="documentEditable"
                 tal:condition="python:checkPermission('Manage users', here)">

                <!-- ugly way of simulating real actions on placeful workflow pages until we have real objects. -->
                <ul class="contentViews">
                    <li id="contentview-workflow-advanced" class="plain">
                        <a href="prefs_workflow_advanced"
                           i18n:translate="label_workflow_global_type_mapping">
                            Global Workflow configuration
                        </a>
                    </li>
                    <li id="contentview-workflow-localpolicies" class="selected">
                        <a href="prefs_workflow_localpolicies_form"
                           i18n:translate="label_workflow_local_type_mapping">
                            Workflow policies configuration
                        </a>
                    </li>
                </ul>

                <div class="contentActions">
                    &nbsp;
                </div>
                <!-- End of tabs -->

                <div class="documentContent" id="region-content">

                    <a name="documentContent"></a>

                    <h1 i18n:translate="heading_placeful_workflow">
                        Placeful Workflow
                    </h1>

                    <a href=""
                       class="link-parent"
                       tal:attributes="href string: $portal_url/plone_control_panel"
                       i18n:domain="plone"
                       i18n:translate="label_up_to_plone_setup">
                        Up to Plone Setup
                    </a>

                    <p i18n:translate="description_workflow_policy_setup">
                        Workflow policies setup for Plone.<br/>
                        Here you will create and configure your workflow policies.
                        A policy modify workflows for your documents in or below
                        a folderish type. To apply a policy you have to add in a
                        folderish a workflow polices local configuration in the
                        workflow dropdown menu.
                    </p>

                    <form action=""
                          name=""
                          method="post"
                          tal:attributes="action string:prefs_workflow_localpolicies_set"
                          tal:define="wfp python:here.portal_placeful_workflow;">

                        <fieldset>

                            <legend i18n:translate="legend_workflow_policies">
                                Workflow Policies
                            </legend>

                            <div tal:repeat="wfpid python:wfp.getWorkflowPolicyIds()"
                                 class="field">

                            <tal:wfp tal:define="wfp python:wfp.getWorkflowPolicyById(wfpid)">

                                <input type="checkbox"
                                       class="noborder"
                                       id="policy_id"
                                       name="policy_ids:list"
                                       tal:attributes="id wfpid; value wfpid" />

                                <label for="policy_id"
                                       tal:attributes="for wfpid">

                                    <a href="prefs_workflow_policy_mapping"
                                       tal:attributes="href python:'prefs_workflow_policy_mapping?wfpid='+wfpid"
                                       tal:content="python:wfp.getId()">
                                        Title of the policy mapping
                                    </a>

                                    <span href="prefs_workflow_policy_mapping"
                                          tal:condition="python:wfp.getTitle()"
                                          tal:content="python:'('+wfp.getTitle().strip()+')'">
                                        Title of the policy mapping
                                    </span>
                                </label>

                                <div class="formHelp"
                                     i18n:translate="help_policy_mapping"
                                     tal:content="python:wfp.getDescription()">
                                    Description of the policy mapping
                                </div>

                            </tal:wfp>
                            </div>

                            <div class="formControls"
                                 tal:condition="python:wfp.getWorkflowPolicyIds()">

                                <input class="context"
                                       tabindex=""
                                       type="submit"
                                       name="delete"
                                       value="Delete"
                                       i18n:attributes="value label_delete;"
                                       tal:attributes="tabindex tabindex/next;"
                                       />
                            </div>

                            <div class="field"
                                 tal:define="error errors/policy_id | nothing;"
                                 tal:attributes="class python:test(error, 'field error', 'field')">

                                <label i18n:translate="label_new_policy">
                                    New policy
                                </label>

                                <div class="formHelp"
                                     id=""
                                     i18n:translate="help_add_new_policies">
                                    Add new policies here
                                </div>

                                <div tal:content="error">Validation error output</div>

                                <input name="policy_id"
                                       value=""
                                       size="30"
                                       tabindex=""
                                       tal:attributes="tabindex tabindex/next;" />
                            </div>

                            <div class="formControls">
                                <input class="context"
                                       tabindex=""
                                       type="submit"
                                       name="add"
                                       value="Add"
                                       i18n:attributes="value label_add;"
                                       tal:attributes="tabindex tabindex/next;" />
                            </div>

                            <input type="hidden"
                                   name="form_submitted"
                                   value="1"
                                   tal:attributes="value template/id" />

                        </fieldset>
                    </form>
                </div>
            </div>

            <div id="content"
                 class="documentEditable"
                 tal:condition="python:not checkPermission('Manage users', here)">
                <tal:block replace="here/raiseUnauthorized" />
            </div>

        </div>
    </body>
</html>


